<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„ÙØ·Ø± Ø§Ù„Ø£Ø¨ÙŠØ¶ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© 7.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-dark: #1a5276;
            --primary: #2c3e50;
            --accent-green: #27ae60;
            --accent-light: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --info-blue: #3498db;
            --bg-light: #f8f9fa;
            --card-bg: #ffffff;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --border-color: #dfe6e9;
            --shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            --shadow-heavy: 0 15px 50px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Cairo', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: white;
            padding: 25px 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-bottom: 4px solid var(--accent-green);
            position: relative;
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .header-controls {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 10px;
        }

        .header-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .header-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        /* Tabs Navigation */
        .tabs {
            display: flex;
            background: white;
            border-bottom: 2px solid var(--border-color);
            padding: 0 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .tab-btn {
            padding: 15px 25px;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tab-btn.active {
            color: var(--primary);
            border-bottom-color: var(--accent-green);
            background: var(--bg-light);
        }

        .tab-btn:hover:not(.active) {
            color: var(--primary);
            background: var(--bg-light);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            max-width: 1600px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .tab-content.active {
            display: block;
        }

        /* Main Container */
        .main-container {
            display: grid;
            grid-template-columns: 450px 1fr;
            gap: 25px;
        }

        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }
        }

        /* Sidebar */
        .sidebar {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 25px;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--primary);
            font-size: 1.1rem;
            margin: 25px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .section-title:first-child {
            margin-top: 0;
        }

        .input-group {
            margin-bottom: 18px;
        }

        .input-group label {
            display: block;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-dark);
        }

        .input-group input, 
        .input-group select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            background: #fff;
            transition: var(--transition);
        }

        .input-group input:focus, 
        .input-group select:focus {
            outline: none;
            border-color: var(--accent-green);
            box-shadow: 0 0 0 3px rgba(39, 174, 96, 0.1);
        }

        .input-note {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 5px;
            display: block;
        }

        .phase-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 8px;
        }

        .phase-2 { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .phase-3 { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .phase-4 { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }

        /* Converter Box */
        .converter-box {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: var(--radius);
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--border-color);
        }

        .converter-box h4 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .converter-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .converter-result {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            text-align: center;
            font-weight: 600;
            color: var(--primary);
        }

        /* Results Panel */
        .results-panel {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            border-top: 4px solid var(--accent-green);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-heavy);
        }

        .stat-card.financial {
            border-top-color: var(--warning);
        }

        .stat-card.environmental {
            border-top-color: var(--info-blue);
        }

        .stat-card label {
            display: block;
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 8px;
        }

        .stat-card .value {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary);
            line-height: 1.2;
        }

        .stat-card .unit {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-right: 5px;
        }

        /* Charts Container */
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
        }

        .chart-box {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            height: 350px;
        }

        .chart-box h3 {
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Comparison Table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .comparison-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            text-align: center;
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        .comparison-table tr:hover {
            background: #f9f9f9;
        }

        .better {
            background: #d4edda !important;
            color: #155724;
            font-weight: 600;
        }

        .worse {
            background: #f8d7da !important;
            color: #721c24;
        }

        /* Canvas Container */
        .canvas-container {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .canvas-container h3 {
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #farmCanvas {
            width: 100%;
            height: auto;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: #fdfdfd;
            display: block;
            margin: 0 auto;
        }

        .canvas-legend {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        /* Guide Section */
        .guide-section {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            border-top: 4px solid var(--info-blue);
        }

        .guide-section h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .guide-section h3 {
            color: var(--accent-green);
            margin: 25px 0 15px 0;
            font-size: 1.2rem;
        }

        .formula-box {
            background: #f8f9fa;
            border-right: 5px solid var(--primary);
            padding: 18px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            border-radius: 0 8px 8px 0;
            overflow-x: auto;
        }

        .phase-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .phase-card {
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .phase-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .phase-card h4 {
            margin-bottom: 10px;
            color: var(--primary);
        }

        /* Buttons */
        .btn-primary {
            background: linear-gradient(to right, var(--accent-green), var(--accent-light));
            color: white;
            border: none;
            padding: 14px 25px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary:hover {
            opacity: 0.9;
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-secondary:hover {
            background: var(--primary);
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
            font-size: 0.9rem;
            border-top: 1px solid var(--border-color);
            margin-top: 40px;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }
            
            .header-controls {
                position: static;
                margin-top: 15px;
                justify-content: center;
            }
            
            .tabs {
                overflow-x: auto;
            }
            
            .tab-btn {
                padding: 12px 15px;
                font-size: 0.9rem;
                white-space: nowrap;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .phase-info-grid {
                grid-template-columns: 1fr;
            }
            
            .converter-inputs {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .tab-content {
                padding: 0 10px;
            }
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--accent-green);
            color: white;
            padding: 15px 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-heavy);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.3s, opacity 0.3s;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.error {
            background: var(--danger);
        }

        .toast.warning {
            background: var(--warning);
        }
    </style>
</head>
<body>
    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­</span>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="header-controls">
            <button class="header-btn" onclick="saveConfiguration()">
                <i class="fas fa-save"></i> Ø­ÙØ¸
            </button>
            <button class="header-btn" onclick="loadConfiguration()">
                <i class="fas fa-folder-open"></i> ØªØ­Ù…ÙŠÙ„
            </button>
            <button class="header-btn" onclick="exportToPDF()">
                <i class="fas fa-file-pdf"></i> ØªØµØ¯ÙŠØ±
            </button>
        </div>
        
        <h1><i class="fas fa-mushroom"></i>Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„ÙØ·Ø± Ø§Ù„Ø£Ø¨ÙŠØ¶</h1>
        <p>Ø§Ù„Ø¥ØµØ¯Ø§Ø± 7.0 - Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ù„ØªØ®Ø·ÙŠØ· ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ ÙˆØ§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ</p>
    </div>

    <!-- Tabs Navigation -->
    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('planning')">
            <i class="fas fa-calculator"></i> Ø§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
        </button>
        <button class="tab-btn" onclick="switchTab('peat')">
            <i class="fas fa-layer-group"></i> Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³
        </button>
        <button class="tab-btn" onclick="switchTab('comparison')">
            <i class="fas fa-balance-scale"></i> Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
        </button>
        <button class="tab-btn" onclick="switchTab('charts')">
            <i class="fas fa-chart-pie"></i> Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
        </button>
    </div>

    <!-- Tab 1: Planning -->
    <div id="planning-tab" class="tab-content active">
        <div class="main-container">
            <!-- Sidebar: Inputs Panel -->
            <aside class="sidebar">
                <div class="section-title">
                    <i class="fas fa-ruler-combined"></i>
                    <h3>ğŸ“ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© Ù„Ù„ØµØ§Ù„Ø©</h3>
                </div>
                
                <div class="input-group">
                    <label for="roomLength">Ø·ÙˆÙ„ Ø§Ù„ØµØ§Ù„Ø© (Ù…ØªØ±) <span class="input-note">[Ø§Ù„Ø£Ø¯Ù†Ù‰: 2Ù…ØŒ Ø§Ù„Ø£Ù‚ØµÙ‰: 50Ù…]</span></label>
                    <input type="number" id="roomLength" value="18" min="2" max="50" step="0.1" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="roomWidth">Ø¹Ø±Ø¶ Ø§Ù„ØµØ§Ù„Ø© (Ù…ØªØ±) <span class="input-note">[Ø§Ù„Ø£Ø¯Ù†Ù‰: 2Ù…ØŒ Ø§Ù„Ø£Ù‚ØµÙ‰: 20Ù…]</span></label>
                    <input type="number" id="roomWidth" value="5.5" min="2" max="20" step="0.1" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="aisleWidth">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù…Ø± Ø§Ù„Ø·ÙˆÙ„ÙŠ (Ù…ØªØ±) <span class="input-note">[Ø§Ù„Ù…Ø¹ÙŠØ§Ø±: 0.8Ù… Ù„Ù„Ø®Ø¯Ù…Ø©]</span></label>
                    <input type="number" id="aisleWidth" value="0.8" min="0.5" max="2" step="0.1" oninput="validateInputs()">
                </div>

                <div class="section-title">
                    <i class="fas fa-layer-group"></i>
                    <h3>ğŸ—„ï¸ ØªØµÙ…ÙŠÙ… Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙÙˆÙ</h3>
                </div>
                
                <div class="input-group">
                    <label for="shelfLevels">Ø¹Ø¯Ø¯ Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø±ÙÙˆÙ <span class="input-note">[Ø§Ù„Ù…Ø¹ÙŠØ§Ø±: 5 Ø·Ø¨Ù‚Ø§Øª]</span></label>
                    <input type="number" id="shelfLevels" value="5" min="1" max="10" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="shelfWidth">Ø¹Ø±Ø¶ Ø§Ù„Ø±Ù Ø§Ù„ÙˆØ§Ø­Ø¯ (Ù…ØªØ±) <span class="input-note">[Ø§Ù„Ù…Ø¹ÙŠØ§Ø± Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ: 1.2Ù…]</span></label>
                    <input type="number" id="shelfWidth" value="1.2" min="0.5" max="2" step="0.1" oninput="validateInputs()">
                </div>

                <div class="section-title">
                    <i class="fas fa-seedling"></i>
                    <h3>ğŸŒ± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</h3>
                </div>
                
                <div class="input-group">
                    <label for="compostPhase">Ø·ÙˆØ± Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª (Phase)</label>
                    <select id="compostPhase" onchange="updatePhaseSettings()">
                        <option value="2">Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ø§Ù†ÙŠ (Phase II) - Ù…Ø¹Ù‚Ù…/ÙŠØ­ØªØ§Ø¬ ØªÙ„Ù‚ÙŠØ­</option>
                        <option value="3" selected>Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø« (Phase III) - Ù…Ù„Ù‚Ø­ ÙˆÙ…Ø­ØªÙ„ Ø¬Ø§Ù‡Ø²</option>
                        <option value="4">Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø¹ (Phase IV) - Ù…ØºØ·Ù‰ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø«Ù…Ø§Ø±</option>
                    </select>
                    <div id="phaseBadge" class="phase-badge phase-3">Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«: 6-7 Ø¯ÙˆØ±Ø§Øª/Ø³Ù†Ø©</div>
                </div>
                
                <div class="input-group">
                    <label for="compostDensity">ÙƒØ«Ø§ÙØ© Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª (ÙƒØ¬Ù…/Ù…Â²) <span class="input-note">[Ø§Ù„Ù…Ø¹ÙŠØ§Ø± Ø§Ù„Ø³ÙˆØ±ÙŠ: 95-100 ÙƒØ¬Ù…/Ù…Â²]</span></label>
                    <input type="number" id="compostDensity" value="95" min="70" max="120" step="1" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="yieldPerSqM">Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ (ÙƒØ¬Ù…/Ù…Â²) <span class="input-note">[Ø§Ù„Ø³ÙˆØ±ÙŠ: 30-45 ÙƒØ¬Ù…/Ù…Â² Ø­Ø³Ø¨ Ø§Ù„ØªØ­ÙƒÙ…]</span></label>
                    <input type="number" id="yieldPerSqM" value="30" min="10" max="60" step="1" oninput="validateInputs()">
                </div>

                <div class="section-title">
                    <i class="fas fa-chart-line"></i>
                    <h3>ğŸ’° Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h3>
                </div>
                
                <div class="input-group">
                    <label for="exchangeRate">Ø³Ø¹Ø± ØµØ±Ù Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± (Ù„ÙŠØ±Ø© Ø³ÙˆØ±ÙŠØ©) <span class="input-note">[Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ù„Ù„ÙŠØ±Ø©]</span></label>
                    <input type="number" id="exchangeRate" value="15000" min="1000" max="100000" step="1000" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="compostPrice">Ø³Ø¹Ø± Ø·Ù† Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª ($) <span class="input-note">[Ø­Ø³Ø¨ Ø§Ù„Ø·ÙˆØ± ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©]</span></label>
                    <input type="number" id="compostPrice" value="280" min="100" max="500" step="10" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="mushroomPrice">Ø³Ø¹Ø± Ø¨ÙŠØ¹ Ø§Ù„ÙƒÙŠÙ„Ùˆ ($) <span class="input-note">[Ø³Ø¹Ø± Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹]</span></label>
                    <input type="number" id="mushroomPrice" value="2.5" min="0.5" max="10" step="0.1" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="operationalCosts">Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©/Ø¯ÙˆØ±Ø© ($) <span class="input-note">[ÙƒÙ‡Ø±Ø¨Ø§Ø¡ØŒ Ø¹Ù…Ø§Ù„Ø©ØŒ ØµÙŠØ§Ù†Ø©]</span></label>
                    <input type="number" id="operationalCosts" value="400" min="0" max="5000" step="50" oninput="validateInputs()">
                </div>

                <button class="btn-primary" onclick="calculateAll()">
                    <i class="fas fa-calculator"></i> ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ§Ù„Ø±Ø³Ù…
                </button>
                
                <div class="btn-group">
                    <button class="btn-secondary" onclick="resetToDefaults()">
                        <i class="fas fa-undo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·
                    </button>
                    <button class="btn-secondary" onclick="saveConfiguration()">
                        <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„ØªÙƒÙˆÙŠÙ†
                    </button>
                </div>
            </aside>

            <!-- Main Content: Results Panel -->
            <main class="results-panel">
                <!-- Results Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <label><i class="fas fa-vector-square"></i> Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙØ¹Ø§Ù„Ø© Ø§Ù„ÙƒÙ„ÙŠØ©</label>
                        <div class="value" id="totalArea">0</div>
                        <span class="unit">Ù…ØªØ± Ù…Ø±Ø¨Ø¹</span>
                    </div>
                    
                    <div class="stat-card">
                        <label><i class="fas fa-weight-hanging"></i> Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨/Ø¯ÙˆØ±Ø©</label>
                        <div class="value" id="totalCompost">0</div>
                        <span class="unit">Ø·Ù†</span>
                    </div>
                    
                    <div class="stat-card">
                        <label><i class="fas fa-tint"></i> Ø§Ø­ØªÙŠØ§Ø¬ Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³/Ø¯ÙˆØ±Ø©</label>
                        <div class="value" id="totalPeat">0</div>
                        <span class="unit">Ù„ØªØ±</span>
                    </div>
                    
                    <div class="stat-card">
                        <label><i class="fas fa-chart-bar"></i> Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø³Ù†ÙˆÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ</label>
                        <div class="value" id="annualYield">0</div>
                        <span class="unit">Ø·Ù†</span>
                    </div>
                    
                    <div class="stat-card financial">
                        <label><i class="fas fa-dollar-sign"></i> Ø±Ø¨Ø­ Ø§Ù„Ø¯ÙˆØ±Ø© ($)</label>
                        <div class="value" id="profitCycle">0</div>
                        <span class="unit">Ø¯ÙˆÙ„Ø§Ø±</span>
                    </div>
                    
                    <div class="stat-card financial">
                        <label><i class="fas fa-money-bill-wave"></i> Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (Ù„.Ø³)</label>
                        <div class="value" id="profitAnnualSYP">0</div>
                        <span class="unit">Ù„ÙŠØ±Ø© Ø³ÙˆØ±ÙŠØ©</span>
                    </div>
                </div>

                <!-- Canvas Drawing -->
                <div class="canvas-container">
                    <h3><i class="fas fa-drafting-compass"></i> Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ ÙˆØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø­Ù…Ø§Ù„</h3>
                    <canvas id="farmCanvas" width="1000" height="500"></canvas>
                    
                    <div class="canvas-legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #27ae60;"></div>
                            <span>Ø§Ù„Ø±ÙÙˆÙ (Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø©)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #ffffff; border: 1px solid #ddd;"></div>
                            <span>Ø§Ù„Ù…Ù…Ø±Ø§Øª (Ø­Ø±ÙƒØ© Ø§Ù„Ø®Ø¯Ù…Ø©)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #3498db;"></div>
                            <span>Ø§Ù„Ù…Ù…Ø± Ø§Ù„Ø¹Ø±Ø¶ÙŠ (Ù„Ù„Ø£Ø·ÙˆØ§Ù„ > 12Ù…)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #2c3e50;"></div>
                            <span>Ø¬Ø¯Ø±Ø§Ù† Ø§Ù„ØµØ§Ù„Ø©</span>
                        </div>
                    </div>
                    
                    <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 15px;">
                        <i class="fas fa-lightbulb"></i> <strong>Ù…Ø¹Ù„ÙˆÙ…Ø©:</strong> Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø±ÙÙˆÙ ØªÙ…Ø«Ù„ ÙˆØ²Ù† Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª (Ø¨Ø§Ù„Ø£Ø·Ù†Ø§Ù†) Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø±ÙÙˆÙ
                    </p>
                </div>

            <!-- Guide Section -->
            <div class="guide-section">
                <h2><i class="fas fa-book-open"></i> Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ù…ÙŠ ÙˆØ§Ù„Ø¥Ø±Ø´Ø§Ø¯ÙŠ Ù„Ù„Ù†Ø¸Ø§Ù…</h2>
                
                <div class="phase-info-grid">
                    <div class="phase-card">
                        <h4>Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ø§Ù†ÙŠ (Phase II)</h4>
                        <p>ÙƒÙˆÙ…Ø¨ÙˆØ³Øª Ù…Ø¹Ù‚Ù… ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¹Ù…Ù„ÙŠØ© ØªÙ„Ù‚ÙŠØ­ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©. ÙŠØ­ØªØ§Ø¬ 15-20 ÙŠÙˆÙ… ØªØ­Ø¶ÙŠÙ†. ÙŠÙˆÙØ± 4-5 Ø¯ÙˆØ±Ø§Øª/Ø³Ù†Ø©.</p>
                    </div>
                    
                    <div class="phase-card" style="border-color: #27ae60;">
                        <h4>Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø« (Phase III)</h4>
                        <p>ÙƒÙˆÙ…Ø¨ÙˆØ³Øª Ù…Ù„Ù‚Ø­ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ø²Ø±Ø§Ø¹Ø© Ù…Ø¨Ø§Ø´Ø±Ø©. ÙŠÙˆÙØ± 6-7 Ø¯ÙˆØ±Ø§Øª/Ø³Ù†Ø© (Ø§Ù„Ù…Ø¹ÙŠØ§Ø± Ø§Ù„Ø³ÙˆØ±ÙŠ). Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø£Ø¹Ù„Ù‰ Ø¨Ù†Ø³Ø¨Ø© 15%.</p>
                    </div>
                    
                    <div class="phase-card">
                        <h4>Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø¹ (Phase IV)</h4>
                        <p>ÙƒÙˆÙ…Ø¨ÙˆØ³Øª Ù…ØºØ·Ù‰ ÙˆØªØ±Ø¨ØªÙ‡ Ù…Ø³ØªØ¹Ù…Ø±Ø© Ø¨Ø§Ù„Ù…Ø´ÙŠØ¬Ø©. Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø«Ù…Ø§Ø± Ù…Ø¨Ø§Ø´Ø±Ø©. ÙŠÙˆÙØ± 8-10 Ø¯ÙˆØ±Ø§Øª/Ø³Ù†Ø© ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©.</p>
                    </div>
                </div>
                
                <h3>ğŸ§® Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©</h3>
                <div class="formula-box">
                    // 1. Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ ØµÙÙˆÙ Ø§Ù„Ø±ÙÙˆÙ<br>
                    ØµÙÙˆÙ = âŒŠ(Ø¹Ø±Ø¶_Ø§Ù„ØµØ§Ù„Ø© - 1) Ã· (Ø¹Ø±Ø¶_Ø§Ù„Ø±Ù + Ø¹Ø±Ø¶_Ø§Ù„Ù…Ù…Ø±)âŒ‹<br><br>
                    
                    // 2. Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙØ¹Ø§Ù„Ø©<br>
                    Ù…Ø³Ø§Ø­Ø©_Ø§Ù„Ø±Ù_Ø§Ù„ÙˆØ§Ø­Ø¯ = Ø·ÙˆÙ„_Ø§Ù„Ø±Ù_Ø§Ù„ØµØ§ÙÙŠ Ã— Ø¹Ø±Ø¶_Ø§Ù„Ø±Ù<br>
                    Ù…Ø³Ø§Ø­Ø©_ÙƒÙ„_Ø§Ù„Ø·Ø¨Ù‚Ø§Øª = Ù…Ø³Ø§Ø­Ø©_Ø§Ù„Ø±Ù_Ø§Ù„ÙˆØ§Ø­Ø¯ Ã— Ø¹Ø¯Ø¯_Ø§Ù„Ø·Ø¨Ù‚Ø§Øª<br>
                    Ø§Ù„Ù…Ø³Ø§Ø­Ø©_Ø§Ù„ÙƒÙ„ÙŠØ© = Ù…Ø³Ø§Ø­Ø©_ÙƒÙ„_Ø§Ù„Ø·Ø¨Ù‚Ø§Øª Ã— Ø¹Ø¯Ø¯_Ø§Ù„ØµÙÙˆÙ<br><br>
                    
                    // 3. Ø­Ø³Ø§Ø¨ ÙƒÙ…ÙŠØ© Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª<br>
                    ÙƒÙ…ÙŠØ©_Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª(Ø·Ù†) = (Ø§Ù„Ù…Ø³Ø§Ø­Ø©_Ø§Ù„ÙƒÙ„ÙŠØ© Ã— Ø§Ù„ÙƒØ«Ø§ÙØ©) Ã· 1000<br><br>
                    
                    // 4. Ø­Ø³Ø§Ø¨ ÙƒÙ…ÙŠØ© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³<br>
                    ÙƒÙ…ÙŠØ©_Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³(Ù„ØªØ±) = Ø§Ù„Ù…Ø³Ø§Ø­Ø©_Ø§Ù„ÙƒÙ„ÙŠØ© Ã— 45 (Ù„ØªØ±/Ù…Â²)<br><br>
                    
                    // 5. Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©<br>
                    Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯_Ø§Ù„Ø¯ÙˆØ±Ø© = (Ø§Ù„Ø¥Ù†ØªØ§Ø¬_Ø§Ù„Ø¯ÙˆØ±Ø© Ã— Ø³Ø¹Ø±_Ø§Ù„ÙƒÙŠÙ„Ùˆ)<br>
                    Ø§Ù„ØªÙƒÙ„ÙØ©_Ø§Ù„Ø¯ÙˆØ±Ø© = (ÙƒÙ…ÙŠØ©_Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª Ã— Ø³Ø¹Ø±_Ø§Ù„Ø·Ù†) + Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ_Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©<br>
                    Ø§Ù„Ø±Ø¨Ø­_Ø§Ù„Ø¯ÙˆØ±Ø© = Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯_Ø§Ù„Ø¯ÙˆØ±Ø© - Ø§Ù„ØªÙƒÙ„ÙØ©_Ø§Ù„Ø¯ÙˆØ±Ø©
                </div>
                
                <h3>ğŸ“Š Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø³ÙˆØ±ÙŠØ© (Ø­Ø³Ø¨ Ù…Ø±ÙƒØ² Ø¨Ø­ÙˆØ« Ø­Ù„Ø¨)</h3>
                <ul style="padding-right: 20px; margin-bottom: 20px;">
                    <li>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¥Ù†ØªØ§Ø¬: 30 ÙƒØ¬Ù…/Ù…Â² (ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù€ 45 ÙƒØ¬Ù…/Ù…Â² Ù…Ø¹ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ)</li>
                    <li>ÙƒØ«Ø§ÙØ© Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª: 95-100 ÙƒØ¬Ù…/Ù…Â² Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø§Ù„Ø¹Ø§Ù„ÙŠØ©</li>
                    <li>Ø³Ù…Ø§ÙƒØ© ØªØºØ·ÙŠØ© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³: 4-5 Ø³Ù… (ØªØ¹Ø§Ø¯Ù„ 45 Ù„ØªØ±/Ù…Â²)</li>
                    <li>Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø³Ù†ÙˆÙŠØ©: 5-7 Ø¯ÙˆØ±Ø§Øª Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª</li>
                    <li>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ø«Ù„Ù‰ Ù„Ù„Ø¥Ø«Ù…Ø§Ø±: 16-18Â°Ù…</li>
                    <li>Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ø§Ù„Ù†Ø³Ø¨ÙŠØ© Ø§Ù„Ù…Ø«Ù„Ù‰: 85-90%</li>
                </ul>
                
                <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin-top: 20px; border-right: 4px solid var(--accent-green);">
                    <h4 style="color: var(--accent-green); margin-bottom: 10px;"><i class="fas fa-lightbulb"></i> Ù†ØµØ§Ø¦Ø­ Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©</h4>
                    <p>1. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª Ù…Ù† Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø« Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ù„Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø³Ù†ÙˆÙŠØ©.<br>
                    2. Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ø¨Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© (16-18Â°Ù…) ÙˆØ§Ù„Ø±Ø·ÙˆØ¨Ø© (85-90%) Ø®Ù„Ø§Ù„ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø«Ù…Ø§Ø±.<br>
                    3. Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙ‡ÙˆÙŠØ© Ø§Ù„Ø¬ÙŠØ¯Ø© Ù„ØªÙ‚Ù„ÙŠÙ„ ØªØ±ÙƒÙŠØ² COâ‚‚ ØªØ­Øª 1500 ppm.<br>
                    4. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙŠØ§Ù‡ Ø°Ø§Øª Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© Ø®Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ù„ÙˆØ«Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ø§Ø¯Ù† Ø§Ù„Ø«Ù‚ÙŠÙ„Ø©.</p>
                </div>
            </div>
            </main>
        </div>
    </div>

    <!-- Tab 2: Peat Calculator -->
    <div id="peat-tab" class="tab-content">
        <div class="main-container">
            <aside class="sidebar">
                <div class="section-title">
                    <i class="fas fa-calculator"></i>
                    <h3>ğŸ§® Ø­Ø§Ø³Ø¨Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³</h3>
                </div>
                
                <div class="converter-box">
                    <h4><i class="fas fa-exchange-alt"></i> ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø­Ø¬Ù… â†â†’ Ø§Ù„ÙˆØ²Ù†</h4>
                    
                    <div class="converter-inputs">
                        <div class="input-group">
                            <label for="convertVolume">Ø§Ù„Ø­Ø¬Ù… (Ù„ØªØ±)</label>
                            <input type="number" id="convertVolume" value="1000" min="0" step="100" oninput="convertPeatUnits()">
                        </div>
                        
                        <div class="input-group">
                            <label for="convertWeight">Ø§Ù„ÙˆØ²Ù† (ÙƒØ¬Ù…)</label>
                            <input type="number" id="convertWeight" value="120" min="0" step="10" oninput="convertPeatUnits('weight')">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="peatDensitySelect">ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ (ÙƒØ¬Ù…/Ù„ØªØ±)</label>
                        <select id="peatDensitySelect" onchange="convertPeatUnits()">
                            <option value="0.10">Ø®ÙÙŠÙ: 0.10 (Ø¨ÙŠØªÙ…ÙˆØ³ Ø¬Ø§Ù)</option>
                            <option value="0.12" selected>Ù…ØªÙˆØ³Ø·: 0.12 (Ø¨ÙŠØªÙ…ÙˆØ³ Ø±Ø·Ø¨ 75%)</option>
                            <option value="0.15">Ø«Ù‚ÙŠÙ„: 0.15 (Ø¨ÙŠØªÙ…ÙˆØ³ Ù…Ø´Ø¨Ø¹)</option>
                            <option value="0.11">Ø®Ù„Ø·Ø© Ø¨ÙŠØ±Ù„Ø§ÙŠØª: 0.11</option>
                        </select>
                    </div>
                    
                    <div class="converter-result" id="conversionResult">
                        1000 Ù„ØªØ± = 120 ÙƒØ¬Ù… (ÙƒØ«Ø§ÙØ© 0.12 ÙƒØ¬Ù…/Ù„ØªØ±)
                    </div>
                </div>
                
                <div class="section-title">
                    <i class="fas fa-layer-group"></i>
                    <h3>ğŸŸ« Ø®ØµØ§Ø¦Øµ Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ ÙˆØ·Ø¨Ù‚Ø© Ø§Ù„ØªØºØ·ÙŠØ©</h3>
                </div>
                
                <div class="input-group">
                    <label for="peatType">Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³</label>
                    <select id="peatType" onchange="updatePeatCalculations()">
                        <option value="1">Ø¨ÙŠØªÙ…ÙˆØ³ Ø³ÙØ§Ø¬Ù†ÙˆÙ… Ø­Ø§Ù…Ø¶ÙŠ (pH 3.5-4.5)</option>
                        <option value="2" selected>Ø¨ÙŠØªÙ…ÙˆØ³ Ù…Ø¹Ø§Ù„Ø¬ Ø¨Ø§Ù„ÙƒÙ„Ø³ (pH 6.5-7.5)</option>
                        <option value="3">Ø®Ù„Ø·Ø© Ù…Ø®ØªÙ„Ø·Ø© (Ø¨ÙŠØªÙ…ÙˆØ³ + Ø¨ÙŠØ±Ù„Ø§ÙŠØª)</option>
                        <option value="4">Ø¨ÙŠØªÙ…ÙˆØ³ Ù…Ø¹Ø§Ù„Ø¬ Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="peatThickness">Ø³Ù…Ùƒ Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØºØ·ÙŠØ© (Ø³Ù…) <span class="input-note">[Ø§Ù„Ù…Ø¹ÙŠØ§Ø±: 4-5 Ø³Ù…]</span></label>
                    <input type="number" id="peatThickness" value="4.5" min="3" max="7" step="0.1" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="addPerlite">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ±Ù„Ø§ÙŠØª (%) <span class="input-note">[ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªÙ‡ÙˆÙŠØ© - Ø§Ø®ØªÙŠØ§Ø±ÙŠ]</span></label>
                    <input type="number" id="addPerlite" value="0" min="0" max="30" step="5" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="peatPrice">Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ ($/Ù„ØªØ±) <span class="input-note">[Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³ÙˆØ±ÙŠ: 0.02-0.05 $/Ù„ØªØ±]</span></label>
                    <input type="number" id="peatPrice" value="0.03" min="0.01" max="0.1" step="0.005" oninput="validateInputs()">
                </div>
                
                <div class="input-group">
                    <label for="treatmentMethod">Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³</label>
                    <select id="treatmentMethod" onchange="updateTreatmentCost()">
                        <option value="none">Ø¨Ø¯ÙˆÙ† Ù…Ø¹Ø§Ù„Ø¬Ø© (pH < 5)</option>
                        <option value="pasteurization" selected>Ø¨Ø³ØªØ±Ø© (70Â°Ù… Ù„Ù…Ø¯Ø© Ø³Ø§Ø¹ØªÙŠÙ†)</option>
                        <option value="sterilization">ØªØ¹Ù‚ÙŠÙ… ÙƒØ§Ù…Ù„ (Ø¨Ø®Ø§Ø± 121Â°Ù…)</option>
                        <option value="chemical">Ù…Ø¹Ø§Ù„Ø¬Ø© ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠØ© (ÙÙˆØ±Ù…Ø§Ù„ÙŠÙ†)</option>
                    </select>
                    <div id="treatmentCostBadge" class="phase-badge phase-2" style="margin-top: 5px;">ØªÙƒÙ„ÙØ© Ø¨Ø³ØªØ±Ø©: 0.002 $/Ù„ØªØ±</div>
                </div>
                
                <div class="input-group">
                    <label for="targetMoisture">Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© (%) <span class="input-note">[Ø§Ù„Ù…Ø«Ù„Ù‰: 72-76%]</span></label>
                    <input type="number" id="targetMoisture" value="75" min="65" max="80" step="1" oninput="validateInputs()">
                </div>
                
                <button class="btn-primary" onclick="calculatePeatRequirements()">
                    <i class="fas fa-calculator"></i> Ø­Ø³Ø§Ø¨ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³
                </button>
            </aside>
            
            <main class="results-panel">
                <div class="stats-grid">
                    <div class="stat-card environmental">
                        <label><i class="fas fa-seedling"></i> Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</label>
                        <div class="value" id="peatVolumeResult">0</div>
                        <span class="unit">Ù„ØªØ±</span>
                    </div>
                    
                    <div class="stat-card">
                        <label><i class="fas fa-weight"></i> ÙˆØ²Ù† Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ Ø§Ù„Ø±Ø·Ø¨</label>
                        <div class="value" id="peatWeightResult">0</div>
                        <span class="unit">Ø·Ù†</span>
                    </div>
                    
                    <div class="stat-card financial">
                        <label><i class="fas fa-dollar-sign"></i> ØªÙƒÙ„ÙØ© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³/Ø¯ÙˆØ±Ø©</label>
                        <div class="value" id="peatCostResult">0</div>
                        <span class="unit">Ø¯ÙˆÙ„Ø§Ø±</span>
                    </div>
                    
                    <div class="stat-card financial">
                        <label><i class="fas fa-money-bill"></i> ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</label>
                        <div class="value" id="treatmentCostResult">0</div>
                        <span class="unit">Ø¯ÙˆÙ„Ø§Ø±</span>
                    </div>
                    
                    <div class="stat-card">
                        <label><i class="fas fa-percentage"></i> Ù†Ø³Ø¨Ø© Ø§Ù„Ø¨ÙŠØ±Ù„Ø§ÙŠØª</label>
                        <div class="value" id="perlitePercentage">0</div>
                        <span class="unit">%</span>
                    </div>
                    
                    <div class="stat-card financial">
                        <label><i class="fas fa-percentage"></i> Ù†Ø³Ø¨Ø© ØªÙƒÙ„ÙØ© Ø§Ù„ØªØºØ·ÙŠØ©</label>
                        <div class="value" id="peatCostPercentageResult">0</div>
                        <span class="unit">% Ù…Ù† Ø§Ù„ØªÙƒÙ„ÙØ©</span>
                    </div>
                </div>
                
                <div class="canvas-container">
                    <h3><i class="fas fa-info-circle"></i> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø®Ù„Ø·Ø© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©</h3>
                    <div id="peatInfoBox" style="padding: 20px; background: linear-gradient(135deg, #e8f5e9, #c8e6c9); border-radius: 8px;">
                        <h4 style="color: var(--primary); margin-bottom: 15px;">Ø§Ù„Ø®Ù„Ø·Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© (Ù…Ø±ÙƒØ² Ø¨Ø­ÙˆØ« Ø­Ù„Ø¨)</h4>
                        <p><strong>Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ø­Ø¬Ù…ÙŠØ©:</strong></p>
                        <ul style="padding-right: 20px; margin-bottom: 15px;">
                            <li>80% Ø¨ÙŠØªÙ…ÙˆØ³</li>
                            <li>10-15% Ø±Ù…Ù„ Ù†Ù‡Ø±ÙŠ Ù†Ø§Ø¹Ù…</li>
                            <li>5-10% ÙƒØ±Ø¨ÙˆÙ†Ø§Øª ÙƒØ§Ù„Ø³ÙŠÙˆÙ… (Ù„Ø¶Ø¨Ø· pH)</li>
                        </ul>
                        <p><strong>Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª:</strong> Ø±Ø·ÙˆØ¨Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© 75-76%ØŒ Ø³Ù…Ùƒ 4-5 Ø³Ù…ØŒ ÙƒØ«Ø§ÙØ© Ø±Ø·Ø¨Ø© 0.12-0.14 ÙƒØ¬Ù…/Ù„ØªØ±</p>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: #e3f2fd; border-radius: 8px; border-right: 4px solid var(--info-blue);">
                        <h4 style="color: var(--info-blue); margin-bottom: 10px;"><i class="fas fa-lightbulb"></i> Ù†ØµØ§Ø¦Ø­ Ù„ØªØ­Ø³ÙŠÙ† Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØºØ·ÙŠØ©</h4>
                        <p>1. Ø¥Ø¶Ø§ÙØ© 20% Ø¨ÙŠØ±Ù„Ø§ÙŠØª ØªØ²ÙŠØ¯ Ø§Ù„ØªÙ‡ÙˆÙŠØ© ÙˆØªÙ‚Ù„Ù„ Ø§Ù„Ø¥ØµØ§Ø¨Ø© Ø¨Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ Ø¨Ù†Ø³Ø¨Ø© 30%<br>
                        2. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ ØªÙ‚Ù„Ù„ Ø§Ù„ØªÙ„ÙˆØ« Ø§Ù„Ù…ÙŠÙƒØ±ÙˆØ¨ÙŠ Ø¨Ù†Ø³Ø¨Ø© 90%<br>
                        3. Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ø§Ù„Ù…Ø«Ù„Ù‰ (72-76%) ØªÙ‚Ù„Ù„ Ù…Ù† ØªØ´ÙˆÙ‡ Ø§Ù„Ø£Ø¬Ø³Ø§Ù… Ø§Ù„Ø«Ù…Ø±ÙŠØ©<br>
                        4. Ø³Ù…Ùƒ 4-5 Ø³Ù… ÙŠØ²ÙŠØ¯ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø¨Ù†Ø³Ø¨Ø© 15-20% Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø³Ù…Ùƒ 3 Ø³Ù…</p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Tab 3: Comparison Table -->
    <div id="comparison-tab" class="tab-content">
        <div class="guide-section">
            <h2><i class="fas fa-balance-scale"></i> Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø´Ø§Ù…Ù„ - Ø®Ù„Ø·Ø§Øª Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³</h2>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù…Ø¹ÙŠØ§Ø±</th>
                        <th>Ø§Ù„Ø®Ù„Ø·Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© (Ù…Ø±ÙƒØ² Ø­Ù„Ø¨)</th>
                        <th>Ø§Ù„Ø®Ù„Ø·Ø© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©</th>
                        <th>Ø§Ù„Ø®Ù„Ø·Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©</th>
                        <th>Ø§Ù„Ø®Ù„Ø·Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Ù†Ø³Ø¨ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª</strong></td>
                        <td>80% Ø¨ÙŠØªÙ…ÙˆØ³ØŒ 15% Ø±Ù…Ù„ØŒ 5% CaCOâ‚ƒ</td>
                        <td>70% Ø¨ÙŠØªÙ…ÙˆØ³ØŒ 20% Ø¨ÙŠØ±Ù„Ø§ÙŠØªØŒ 10% CaCOâ‚ƒ</td>
                        <td>90% Ø¨ÙŠØªÙ…ÙˆØ³ØŒ 10% CaCOâ‚ƒ</td>
                        <td>65% Ø¨ÙŠØªÙ…ÙˆØ³ØŒ 25% Ø¨ÙŠØ±Ù„Ø§ÙŠØªØŒ 10% CaCOâ‚ƒ</td>
                    </tr>
                    <tr>
                        <td><strong>Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ø§Ù„Ù…Ø«Ù„Ù‰</strong></td>
                        <td>75-76%</td>
                        <td class="better">72-74%</td>
                        <td>76-78%</td>
                        <td class="better">72-74%</td>
                    </tr>
                    <tr>
                        <td><strong>Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (ÙƒØ¬Ù…/Ù„ØªØ±)</strong></td>
                        <td>0.10-0.12</td>
                        <td class="better">0.08-0.10</td>
                        <td>0.12-0.14</td>
                        <td>0.09-0.11</td>
                    </tr>
                    <tr>
                        <td><strong>Ø§Ù„ØªÙ‡ÙˆÙŠØ©</strong></td>
                        <td>Ù…ØªÙˆØ³Ø·Ø©</td>
                        <td class="better">Ù…Ù…ØªØ§Ø²Ø©</td>
                        <td>Ø¶Ø¹ÙŠÙØ©</td>
                        <td class="better">Ù…Ù…ØªØ§Ø²Ø©</td>
                    </tr>
                    <tr>
                        <td><strong>Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ù…Ø§Ø¡</strong></td>
                        <td class="better">Ø¹Ø§Ù„ÙŠØ©</td>
                        <td>Ø¬ÙŠØ¯Ø©</td>
                        <td class="better">Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹</td>
                        <td>Ø¬ÙŠØ¯Ø© Ø¬Ø¯Ø§Ù‹</td>
                    </tr>
                    <tr>
                        <td><strong>Ø§Ù„ØªÙƒÙ„ÙØ©/Ù…Â² ($)</strong></td>
                        <td>1.35</td>
                        <td>1.80</td>
                        <td class="better">1.20</td>
                        <td>2.00</td>
                    </tr>
                    <tr>
                        <td><strong>Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© (+/- %)</strong></td>
                        <td>0% (Ù‚Ø§Ø¹Ø¯Ø©)</td>
                        <td class="better">+15-20%</td>
                        <td class="worse">-10%</td>
                        <td class="better">+20-25%</td>
                    </tr>
                    <tr>
                        <td><strong>Ù…Ù‚Ø§ÙˆÙ…Ø© Ø§Ù„Ø£Ù…Ø±Ø§Ø¶</strong></td>
                        <td>Ø¬ÙŠØ¯Ø©</td>
                        <td class="better">Ù…Ù…ØªØ§Ø²Ø©</td>
                        <td>Ù…ØªÙˆØ³Ø·Ø©</td>
                        <td class="better">Ù…Ù…ØªØ§Ø²Ø©</td>
                    </tr>
                    <tr>
                        <td><strong>Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ØªØ­Ø¶ÙŠØ±</strong></td>
                        <td class="better">Ø³Ù‡Ù„Ø©</td>
                        <td>Ù…ØªÙˆØ³Ø·Ø©</td>
                        <td class="better">Ø³Ù‡Ù„Ø© Ø¬Ø¯Ø§Ù‹</td>
                        <td>Ù…ØªÙˆØ³Ø·Ø©</td>
                    </tr>
                </tbody>
            </table>
            
            <div style="margin-top: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                <div style="background: #fff3cd; padding: 20px; border-radius: 8px; border-right: 4px solid var(--warning);">
                    <h4 style="color: #856404; margin-bottom: 15px;"><i class="fas fa-exclamation-triangle"></i> ØªØ­Ø°ÙŠØ±Ø§Øª Ù‡Ø§Ù…Ø©</h4>
                    <ul style="padding-right: 20px;">
                        <li>Ø§Ù„Ø±Ù…Ù„ Ø§Ù„Ù†Ù‡Ø±ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù†Ø¸ÙŠÙØ§Ù‹ ÙˆØ®Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø£Ù…Ù„Ø§Ø­</li>
                        <li>Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ Ø§Ù„Ø­Ø§Ù…Ø¶ÙŠ (pH < 5) ÙŠØ­ØªØ§Ø¬ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ù„Ø²Ø§Ù…ÙŠØ©</li>
                        <li>Ø²ÙŠØ§Ø¯Ø© Ø³Ù…Ùƒ Ø§Ù„Ø·Ø¨Ù‚Ø© Ø¹Ù† 5 Ø³Ù… ØªÙ‚Ù„Ù„ Ø§Ù„ØªÙ‡ÙˆÙŠØ© ÙˆØªØ³Ø¨Ø¨ Ù…Ø´Ø§ÙƒÙ„</li>
                        <li>Ù†Ù‚Øµ Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ø¹Ù† 70% ÙŠÙ‚Ù„Ù„ Ù…Ù† ØªØ´ÙƒÙ„ Ø§Ù„Ø£Ø¬Ø³Ø§Ù… Ø§Ù„Ø«Ù…Ø±ÙŠØ©</li>
                    </ul>
                </div>
                
                <div style="background: #d4edda; padding: 20px; border-radius: 8px; border-right: 4px solid var(--accent-green);">
                    <h4 style="color: #155724; margin-bottom: 15px;"><i class="fas fa-check-circle"></i> Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª</h4>
                    <ul style="padding-right: 20px;">
                        <li>Ù‚ÙŠØ§Ø³ Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ø¨Ø§Ù„Ù…Ø¬ÙÙ Ø§Ù„Ø­Ø±Ø§Ø±ÙŠ (95Â°Ù… Ù„Ù…Ø¯Ø© 4 Ø³Ø§Ø¹Ø§Øª)</li>
                        <li>Ø¨Ø³ØªØ±Ø© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ Ø¹Ù†Ø¯ 70Â°Ù… Ù„Ù…Ø¯Ø© Ø³Ø§Ø¹ØªÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</li>
                        <li>Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ±Ù„Ø§ÙŠØª Ø¨Ù†Ø³Ø¨Ø© 20% Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¦ÙŠØ©</li>
                        <li>Ø§Ù„ØªØ¨Ø±ÙŠØ¯ Ø¥Ù„Ù‰ 25Â°Ù… Ù‚Ø¨Ù„ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø·Ø¨Ù‚Ø©</li>
                    </ul>
                </div>
            </div>
            
            <h3 style="margin-top: 30px;">ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙƒÙ„ÙØ© ÙˆØ§Ù„Ø¹Ø§Ø¦Ø¯ (ROI)</h3>
            <div class="formula-box">
                // Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ù„Ù„Ø¨ÙŠØªÙ…ÙˆØ³<br>
                ØªÙƒÙ„ÙØ©_Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³_Ø§Ù„Ù…Ø­Ø³Ù† = 1.80 $/Ù…Â² (Ø®Ù„Ø·Ø© Ø¹Ø§Ù„Ù…ÙŠØ©)<br>
                ØªÙƒÙ„ÙØ©_Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³_Ø§Ù„Ø¹Ø§Ø¯ÙŠ = 1.35 $/Ù…Â² (Ø®Ù„Ø·Ø© Ø³ÙˆØ±ÙŠØ©)<br>
                Ø§Ù„ÙØ±Ù‚_ÙÙŠ_Ø§Ù„ØªÙƒÙ„ÙØ© = 0.45 $/Ù…Â²<br><br>
                
                Ø²ÙŠØ§Ø¯Ø©_Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© = 15% (Ù…Ø¹Ø¯Ù„ Ù…ØªÙˆØ³Ø·)<br>
                Ø¥Ù†ØªØ§Ø¬ÙŠØ©_Ø§Ù„Ø£Ø³Ø§Ø³ = 30 ÙƒØ¬Ù…/Ù…Â²<br>
                Ø²ÙŠØ§Ø¯Ø©_Ø§Ù„Ø¥Ù†ØªØ§Ø¬ = 4.5 ÙƒØ¬Ù…/Ù…Â²<br>
                Ù‚ÙŠÙ…Ø©_Ø§Ù„Ø²ÙŠØ§Ø¯Ø© = 4.5 Ã— 2.5 $ = 11.25 $/Ù…Â²<br><br>
                
                Ø§Ù„Ø¹Ø§Ø¦Ø¯_Ø¹Ù„Ù‰_Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± = (11.25 - 0.45) Ã· 0.45 = 2400%<br>
                ÙØªØ±Ø©_Ø§Ø³ØªØ±Ø¯Ø§Ø¯_Ø±Ø£Ø³_Ø§Ù„Ù…Ø§Ù„ = 0.45 Ã· 11.25 Ã— 365 â‰ˆ 15 ÙŠÙˆÙ…Ø§Ù‹
            </div>
        </div>
    </div>

    <!-- Tab 4: Charts -->
    <div id="charts-tab" class="tab-content">
        <div class="guide-section">
            <h2><i class="fas fa-chart-pie"></i> Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ÙˆØ§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h2>
            
            <div class="charts-container">
                <div class="chart-box">
                    <h3><i class="fas fa-chart-pie"></i> ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ/Ø§Ù„Ø¯ÙˆØ±Ø©</h3>
                    <canvas id="costDistributionChart"></canvas>
                </div>
                
                <div class="chart-box">
                    <h3><i class="fas fa-chart-bar"></i> Ù…Ù‚Ø§Ø±Ù†Ø© Ø®Ù„Ø·Ø§Øª Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³</h3>
                    <canvas id="peatComparisonChart"></canvas>
                </div>
                
                <div class="chart-box">
                    <h3><i class="fas fa-chart-line"></i> Ø§Ù„Ø±Ø¨Ø­ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h3>
                    <canvas id="profitabilityChart"></canvas>
                </div>
                
                <div class="chart-box">
                    <h3><i class="fas fa-balance-scale"></i> ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©</h3>
                    <canvas id="sensitivityChart"></canvas>
                </div>
            </div>
            
            <div style="margin-top: 30px; background: white; padding: 25px; border-radius: var(--radius); box-shadow: var(--shadow);">
                <h3><i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
                
                <div class="btn-group" style="margin-top: 20px;">
                    <button class="btn-secondary" onclick="exportData('csv')">
                        <i class="fas fa-file-csv"></i> ØªØµØ¯ÙŠØ± ÙƒÙ€ CSV
                    </button>
                    <button class="btn-secondary" onclick="exportData('excel')">
                        <i class="fas fa-file-excel"></i> ØªØµØ¯ÙŠØ± ÙƒÙ€ Excel
                    </button>
                    <button class="btn-secondary" onclick="exportToPDF()">
                        <i class="fas fa-file-pdf"></i> ØªØµØ¯ÙŠØ± ÙƒÙ€ PDF
                    </button>
                    <button class="btn-secondary" onclick="printReport()">
                        <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                    </button>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                    <h4 style="color: var(--primary); margin-bottom: 10px;"><i class="fas fa-database"></i> Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©</h4>
                    <p>ØªÙ… Ø­ÙØ¸ <span id="savedConfigsCount">0</span> ØªÙƒÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©</p>
                    <div class="btn-group" style="margin-top: 10px;">
                        <button class="btn-secondary" onclick="showSavedConfigs()" style="font-size: 0.8rem;">
                            <i class="fas fa-list"></i> Ø¹Ø±Ø¶ Ø§Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                        </button>
                        <button class="btn-secondary" onclick="clearAllConfigs()" style="font-size: 0.8rem;">
                            <i class="fas fa-trash"></i> Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p><strong>Â© 2026 Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„ÙØ·Ø± Ø§Ù„Ø£Ø¨ÙŠØ¶ (Agaricus bisporus) - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© 7.0</strong></p>
        <p style="margin: 1rem 0;">ğŸ“… <strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:</strong> 12 ÙŠÙ†Ø§ÙŠØ± 2026 | ğŸ‘¤ <strong>Ø¥Ø¹Ø¯Ø§Ø¯:</strong> Ù‚ØªÙŠØ¨Ø© Ø£Ù‚Ø±Ø¹ - Ø­Ù„Ø¨ - Ø³ÙˆØ±ÙŠØ§ | ğŸ“§ <strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> kutaibaa@gmail.com</p>
        <p>Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù…Ø®ØµØµØ© Ù„Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ø£ÙˆÙ„ÙŠ ÙˆØªÙ‚Ø¯ÙŠØ± Ø§Ù„ÙƒÙ…ÙŠØ§Øª - ÙŠÙˆØµÙ‰ Ø¨Ø§Ø³ØªØ´Ø§Ø±Ø© Ø®Ø¨Ø±Ø§Ø¡ Ù…ØªØ®ØµØµÙŠÙ† Ù„Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ÙØ¹Ù„ÙŠ</p>
        <div style="margin-top: 1rem; padding: 1rem; background: white; border-radius: 8px;">
            <p style="font-size: 0.85rem; color: #888; margin: 0;">
                <strong>Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø¹Ù„Ù…ÙŠØ©:</strong><br>
                1. Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ø¨Ø­ÙˆØ« Ø§Ù„Ø¹Ù„Ù…ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ© - Ù…Ø±ÙƒØ² Ø§Ù„Ø¨Ø­ÙˆØ« Ø§Ù„Ø¹Ù„Ù…ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©ØŒ Ù…Ø±ÙƒØ² Ø­Ù„Ø¨<br>
                2. Ø¯Ù„ÙŠÙ„ Ø²Ø±Ø§Ø¹Ø© Ø§Ù„ÙØ·Ø± Ø§Ù„Ø£Ø¨ÙŠØ¶ - ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ©<br>
                3. Mushroom Growers' Handbook - O. Y. (2004)<br>
                4. Ø¹Ù„Ù… ÙØ·Ø±ÙŠØ§Øª Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ - Ø¯. Ù…Ø­Ù…Ø¯ Ø¨ÙŠØ±Ù‚ ÙˆØ¢Ø®Ø±ÙˆÙ†<br>
                5. Ø£Ø¨Ø­Ø§Ø« Ù…Ø±ÙƒØ² Ø¨Ø­ÙˆØ« Ø§Ù„ÙØ·Ø± - Ø¬Ø§Ù…Ø¹Ø© Ø­Ù„Ø¨
            </p>
        </div>
    </footer>

    <script>
        // ==================== Global Variables ====================
        let charts = {};
        let savedConfigurations = JSON.parse(localStorage.getItem('mushroomConfigs')) || [];

        // ==================== Initialization ====================
        document.addEventListener('DOMContentLoaded', function() {
            updateSavedConfigsCount();
            updatePhaseSettings();
            updateTreatmentCost();
            validateInputs();
            calculateAll();
            convertPeatUnits();
            calculatePeatRequirements();
            
            // Initialize charts
            setTimeout(() => {
                updateCharts();
            }, 500);
        });

        // ==================== Tab Switching ====================
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Deactivate all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Activate selected button
            event.target.classList.add('active');
            
            // Update charts if switching to charts tab
            if (tabName === 'charts') {
                setTimeout(() => {
                    updateCharts();
                }, 100);
            }
        }

        // ==================== Phase Settings ====================
        function updatePhaseSettings() {
            const phase = document.getElementById('compostPhase').value;
            const badge = document.getElementById('phaseBadge');
            const yieldInput = document.getElementById('yieldPerSqM');
            
            switch(phase) {
                case "2":
                    badge.textContent = "Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ø§Ù†ÙŠ: 4-5 Ø¯ÙˆØ±Ø§Øª/Ø³Ù†Ø©";
                    badge.className = "phase-badge phase-2";
                    yieldInput.value = 25;
                    break;
                case "3":
                    badge.textContent = "Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«: 6-7 Ø¯ÙˆØ±Ø§Øª/Ø³Ù†Ø© (Ø§Ù„Ù…Ø¹ÙŠØ§Ø± Ø§Ù„Ø³ÙˆØ±ÙŠ)";
                    badge.className = "phase-badge phase-3";
                    yieldInput.value = 30;
                    break;
                case "4":
                    badge.textContent = "Ø§Ù„Ø·ÙˆØ± Ø§Ù„Ø±Ø§Ø¨Ø¹: 8-10 Ø¯ÙˆØ±Ø§Øª/Ø³Ù†Ø©";
                    badge.className = "phase-badge phase-4";
                    yieldInput.value = 35;
                    break;
            }
        }

        // ==================== Input Validation ====================
        function validateInputs() {
            const inputs = [
                {id: 'roomLength', min: 2, max: 50},
                {id: 'roomWidth', min: 2, max: 20},
                {id: 'aisleWidth', min: 0.5, max: 2},
                {id: 'shelfLevels', min: 1, max: 10},
                {id: 'shelfWidth', min: 0.5, max: 2},
                {id: 'compostDensity', min: 70, max: 120},
                {id: 'yieldPerSqM', min: 10, max: 60},
                {id: 'exchangeRate', min: 1000, max: 100000},
                {id: 'compostPrice', min: 100, max: 500},
                {id: 'mushroomPrice', min: 0.5, max: 10},
                {id: 'operationalCosts', min: 0, max: 5000},
                {id: 'peatThickness', min: 3, max: 7},
                {id: 'addPerlite', min: 0, max: 30},
                {id: 'peatPrice', min: 0.01, max: 0.1},
                {id: 'targetMoisture', min: 65, max: 80}
            ];
            
            inputs.forEach(input => {
                const element = document.getElementById(input.id);
                if (!element) return;
                
                let value = parseFloat(element.value);
                
                if (isNaN(value)) {
                    element.value = input.min;
                } else if (value < input.min) {
                    element.value = input.min;
                } else if (value > input.max) {
                    element.value = input.max;
                }
            });
        }

        // ==================== Peat Calculations ====================
        function updatePeatCalculations() {
            const peatType = document.getElementById('peatType').value;
            const thickness = parseFloat(document.getElementById('peatThickness').value);
            
            if (peatType === "3" && thickness < 4) {
                document.getElementById('peatThickness').value = 4.5;
            }
        }

        function updateTreatmentCost() {
            const method = document.getElementById('treatmentMethod').value;
            const badge = document.getElementById('treatmentCostBadge');
            
            let costPerLiter, methodName, badgeClass;
            
            switch(method) {
                case "none":
                    costPerLiter = 0;
                    methodName = "Ø¨Ø¯ÙˆÙ† Ù…Ø¹Ø§Ù„Ø¬Ø©";
                    badgeClass = "phase-4";
                    break;
                case "pasteurization":
                    costPerLiter = 0.002;
                    methodName = "Ø¨Ø³ØªØ±Ø©";
                    badgeClass = "phase-2";
                    break;
                case "sterilization":
                    costPerLiter = 0.005;
                    methodName = "ØªØ¹Ù‚ÙŠÙ… ÙƒØ§Ù…Ù„";
                    badgeClass = "phase-3";
                    break;
                case "chemical":
                    costPerLiter = 0.003;
                    methodName = "Ù…Ø¹Ø§Ù„Ø¬Ø© ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠØ©";
                    badgeClass = "phase-3";
                    break;
                default:
                    costPerLiter = 0.002;
                    methodName = "Ø¨Ø³ØªØ±Ø©";
                    badgeClass = "phase-2";
            }
            
            badge.textContent = `ØªÙƒÙ„ÙØ© ${methodName}: ${costPerLiter.toFixed(3)} $/Ù„ØªØ±`;
            badge.className = `phase-badge ${badgeClass}`;
            
            return costPerLiter;
        }

        // ==================== Unit Converter ====================
        function convertPeatUnits(source = 'volume') {
            const volumeInput = document.getElementById('convertVolume');
            const weightInput = document.getElementById('convertWeight');
            const density = parseFloat(document.getElementById('peatDensitySelect').value);
            const resultDiv = document.getElementById('conversionResult');
            
            if (source === 'volume') {
                const volume = parseFloat(volumeInput.value);
                const weight = volume * density;
                weightInput.value = weight.toFixed(1);
                resultDiv.textContent = `${volume.toLocaleString()} Ù„ØªØ± = ${weight.toFixed(1)} ÙƒØ¬Ù… (ÙƒØ«Ø§ÙØ© ${density} ÙƒØ¬Ù…/Ù„ØªØ±)`;
            } else {
                const weight = parseFloat(weightInput.value);
                const volume = weight / density;
                volumeInput.value = volume.toFixed(0);
                resultDiv.textContent = `${weight.toFixed(1)} ÙƒØ¬Ù… = ${volume.toLocaleString()} Ù„ØªØ± (ÙƒØ«Ø§ÙØ© ${density} ÙƒØ¬Ù…/Ù„ØªØ±)`;
            }
        }

        // ==================== Calculate Peat Requirements ====================
        function calculatePeatRequirements() {
            const totalArea = parseFloat(document.getElementById('totalArea').textContent) || 0;
            const peatThickness = parseFloat(document.getElementById('peatThickness').value);
            const peatPrice = parseFloat(document.getElementById('peatPrice').value);
            const addPerlite = parseInt(document.getElementById('addPerlite').value);
            const targetMoisture = parseInt(document.getElementById('targetMoisture').value);
            
            // Ø­Ø³Ø§Ø¨ Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³
            const peatVolume = totalArea * peatThickness * 10; // Ù„ØªØ±
            
            // Ø­Ø³Ø§Ø¨ Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ±Ù„Ø§ÙŠØª
            const perliteVolume = peatVolume * (addPerlite / 100);
            const totalPeatVolume = peatVolume - perliteVolume;
            
            // Ø­Ø³Ø§Ø¨ ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³ Ø­Ø³Ø¨ Ø§Ù„Ø±Ø·ÙˆØ¨Ø©
            const baseDensity = 0.10; // ÙƒØ«Ø§ÙØ© Ø¬Ø§ÙØ©
            const moistureFactor = targetMoisture / 100;
            const peatDensity = baseDensity * (1 + moistureFactor);
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ²Ù†
            const peatWeight = (totalPeatVolume * peatDensity) / 1000; // Ø·Ù†
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ
            const treatmentCostPerLiter = updateTreatmentCost();
            const treatmentCost = peatVolume * treatmentCostPerLiter;
            const peatCost = (totalPeatVolume * peatPrice) + treatmentCost;
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
            const compostCost = parseFloat(document.getElementById('totalCompost').textContent) * 
                               parseFloat(document.getElementById('compostPrice').value);
            const operationalCosts = parseFloat(document.getElementById('operationalCosts').value);
            const totalCycleCost = compostCost + operationalCosts + peatCost;
            const peatCostPercentage = totalCycleCost > 0 ? (peatCost / totalCycleCost * 100) : 0;
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.getElementById('peatVolumeResult').textContent = Math.round(peatVolume).toLocaleString();
            document.getElementById('peatWeightResult').textContent = peatWeight.toFixed(2);
            document.getElementById('peatCostResult').textContent = peatCost.toFixed(0);
            document.getElementById('treatmentCostResult').textContent = treatmentCost.toFixed(2);
            document.getElementById('perlitePercentage').textContent = addPerlite;
            document.getElementById('peatCostPercentageResult').textContent = peatCostPercentage.toFixed(1);
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø¨Ø¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
            updatePeatInfoBox();
        }

        function updatePeatInfoBox() {
            const peatType = document.getElementById('peatType').value;
            const box = document.getElementById('peatInfoBox');
            
            let title, content;
            
            switch(peatType) {
                case "1":
                    title = "Ø¨ÙŠØªÙ…ÙˆØ³ Ø³ÙØ§Ø¬Ù†ÙˆÙ… Ø­Ø§Ù…Ø¶ÙŠ";
                    content = "<p><strong>Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª:</strong> pH 3.5-4.5ØŒ ÙŠØ­ØªØ§Ø¬ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨Ø§Ù„ÙƒÙ„Ø³ØŒ Ø±Ø·ÙˆØ¨Ø© Ù…Ø«Ù„Ù‰ 70-74%</p>";
                    break;
                case "2":
                    title = "Ø¨ÙŠØªÙ…ÙˆØ³ Ù…Ø¹Ø§Ù„Ø¬ Ø¨Ø§Ù„ÙƒÙ„Ø³";
                    content = "<p><strong>Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª:</strong> pH 6.5-7.5ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…ØŒ Ø±Ø·ÙˆØ¨Ø© Ù…Ø«Ù„Ù‰ 72-76%</p>";
                    break;
                case "3":
                    title = "Ø®Ù„Ø·Ø© Ù…Ø®ØªÙ„Ø·Ø© (Ø¨ÙŠØªÙ…ÙˆØ³ + Ø¨ÙŠØ±Ù„Ø§ÙŠØª)";
                    content = "<p><strong>Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª:</strong> ØªÙ‡ÙˆÙŠØ© Ù…Ù…ØªØ§Ø²Ø©ØŒ Ù…Ù‚Ø§ÙˆÙ…Ø© Ø¹Ø§Ù„ÙŠØ© Ù„Ù„Ø£Ù…Ø±Ø§Ø¶ØŒ Ø±Ø·ÙˆØ¨Ø© Ù…Ø«Ù„Ù‰ 70-74%</p>";
                    break;
                case "4":
                    title = "Ø¨ÙŠØªÙ…ÙˆØ³ Ù…Ø¹Ø§Ù„Ø¬ Ù…Ø³Ø¨Ù‚Ø§Ù‹";
                    content = "<p><strong>Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª:</strong> Ù…Ø¹Ù‚Ù… ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…ØŒ Ø³Ø¹Ø± Ø£Ø¹Ù„Ù‰ Ø¨Ù†Ø³Ø¨Ø© 30%ØŒ ØªÙˆÙÙŠØ± ÙÙŠ ÙˆÙ‚Øª Ø§Ù„ØªØ­Ø¶ÙŠØ±</p>";
                    break;
            }
            
            box.innerHTML = `
                <h4 style="color: var(--primary); margin-bottom: 15px;">${title}</h4>
                ${content}
                <p><strong>Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ù‚Ø¯Ø±Ø©/Ù…Â²:</strong> ${(parseFloat(document.getElementById('peatPrice').value) * 45).toFixed(2)} $</p>
            `;
        }

        // ==================== Main Calculations ====================
        function calculateAll() {
            // Get all input values
            const roomLength = parseFloat(document.getElementById('roomLength').value);
            const roomWidth = parseFloat(document.getElementById('roomWidth').value);
            const aisleWidth = parseFloat(document.getElementById('aisleWidth').value);
            const shelfLevels = parseInt(document.getElementById('shelfLevels').value);
            const shelfWidth = parseFloat(document.getElementById('shelfWidth').value);
            const compostDensity = parseFloat(document.getElementById('compostDensity').value);
            const yieldPerSqM = parseFloat(document.getElementById('yieldPerSqM').value);
            const exchangeRate = parseFloat(document.getElementById('exchangeRate').value);
            const compostPrice = parseFloat(document.getElementById('compostPrice').value);
            const mushroomPrice = parseFloat(document.getElementById('mushroomPrice').value);
            const operationalCosts = parseFloat(document.getElementById('operationalCosts').value);
            const phase = document.getElementById('compostPhase').value;
            
            // Engineering Calculations
            let rowCount = Math.floor((roomWidth - 1) / (shelfWidth + aisleWidth));
            if (rowCount < 1) rowCount = 1;
            
            const needsCrossAisle = roomLength > 12;
            const crossAisleWidth = 1.2;
            
            const effectiveShelfLength = needsCrossAisle ? 
                (roomLength - crossAisleWidth - 1) / 2 : 
                (roomLength - 1);
            
            const areaPerShelf = effectiveShelfLength * shelfWidth;
            const totalArea = areaPerShelf * shelfLevels * rowCount * (needsCrossAisle ? 2 : 1);
            
            // Agriculture Calculations
            const totalCompost = (totalArea * compostDensity) / 1000;
            
            // Peat Calculations
            const peatThickness = parseFloat(document.getElementById('peatThickness').value);
            const totalPeat = totalArea * peatThickness * 10;
            
            // Determine cycles per year
            let cyclesPerYear;
            switch(phase) {
                case "2": cyclesPerYear = 5; break;
                case "3": cyclesPerYear = 6; break;
                case "4": cyclesPerYear = 8; break;
                default: cyclesPerYear = 6;
            }
            
            const productionPerCycle = totalArea * yieldPerSqM;
            const annualYield = (productionPerCycle * cyclesPerYear) / 1000;
            
            // Financial Calculations with peat cost
            const peatCostPerLiter = parseFloat(document.getElementById('peatPrice').value);
            const treatmentCostPerLiter = updateTreatmentCost();
            const peatCost = (totalPeat * peatCostPerLiter) + (totalPeat * treatmentCostPerLiter);
            
            const revenuePerCycle = productionPerCycle * mushroomPrice;
            const costPerCycle = (totalCompost * compostPrice) + operationalCosts + peatCost;
            const profitPerCycle = revenuePerCycle - costPerCycle;
            const annualProfitSYP = profitPerCycle * cyclesPerYear * exchangeRate;
            
            // Update UI
            document.getElementById('totalArea').textContent = totalArea.toFixed(1);
            document.getElementById('totalCompost').textContent = totalCompost.toFixed(1);
            document.getElementById('totalPeat').textContent = Math.round(totalPeat).toLocaleString();
            document.getElementById('annualYield').textContent = annualYield.toFixed(1);
            document.getElementById('profitCycle').textContent = profitPerCycle.toLocaleString(undefined, {maximumFractionDigits: 0});
            document.getElementById('profitAnnualSYP').textContent = annualProfitSYP.toLocaleString(undefined, {maximumFractionDigits: 0});
            
            // Update peat requirements
            calculatePeatRequirements();
            
            // Draw layout
            drawFarmLayout(roomLength, roomWidth, rowCount, shelfWidth, aisleWidth, 
                          effectiveShelfLength, needsCrossAisle, crossAisleWidth, 
                          totalCompost/rowCount/(needsCrossAisle?2:1));
            
            // Update charts
            updateCharts();
        }

        // ==================== Farm Layout Drawing ====================
        function drawFarmLayout(L, W, rows, sW, aW, sL, hasCross, crossW, weightPerBlock) {
            const canvas = document.getElementById('farmCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const margin = 60;
            const scale = Math.min(
                (canvas.width - margin * 2) / L,
                (canvas.height - margin * 2) / W
            );
            
            // Draw room outline
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 4;
            ctx.strokeRect(margin, margin, L * scale, W * scale);
            
            // Draw room dimensions
            ctx.fillStyle = '#2c3e50';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`${L} Ù…`, margin + (L * scale) / 2, margin - 20);
            
            ctx.save();
            ctx.translate(margin - 20, margin + (W * scale) / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.textAlign = 'center';
            ctx.fillText(`${W} Ù…`, 0, 0);
            ctx.restore();
            
            // Draw shelves
            let currentY = margin + (0.5 * scale);
            const shelfColor = '#27ae60';
            const crossAisleColor = '#3498db';
            
            for (let i = 0; i < rows; i++) {
                const x1 = margin + (0.5 * scale);
                ctx.fillStyle = shelfColor;
                ctx.fillRect(x1, currentY, sL * scale, sW * scale);
                
                ctx.fillStyle = 'white';
                ctx.font = 'bold 11px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`${weightPerBlock.toFixed(1)}T`, x1 + 8, currentY + (sW * scale) / 2 + 4);
                
                if (hasCross) {
                    const x2 = x1 + (sL + crossW) * scale;
                    
                    ctx.fillStyle = crossAisleColor;
                    ctx.fillRect(x1 + sL * scale, currentY, crossW * scale, sW * scale);
                    
                    ctx.fillStyle = shelfColor;
                    ctx.fillRect(x2, currentY, sL * scale, sW * scale);
                    
                    ctx.fillStyle = 'white';
                    ctx.fillText(`${weightPerBlock.toFixed(1)}T`, x2 + 8, currentY + (sW * scale) / 2 + 4);
                    
                    if (i === 0) {
                        ctx.fillStyle = '#2c3e50';
                        ctx.font = '10px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(
                            `Ù…Ù…Ø± Ø¹Ø±Ø¶ÙŠ ${crossW}Ù…`, 
                            x1 + sL * scale + (crossW * scale) / 2, 
                            currentY + sW * scale + 15
                        );
                    }
                }
                
                if (i < rows - 1) {
                    ctx.fillStyle = '#7f8c8d';
                    ctx.font = '10px Arial';
                    ctx.textAlign = 'right';
                    ctx.fillText(
                        `Ù…Ù…Ø± ${aW}Ù…`, 
                        margin + L * scale + 10, 
                        currentY + (sW + aW/2) * scale
                    );
                }
                
                currentY += (sW + aW) * scale;
            }
            
            const levels = parseInt(document.getElementById('shelfLevels').value);
            ctx.fillStyle = '#2c3e50';
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(
                `Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª: ${levels} Ù…Ø³ØªÙˆÙŠØ§Øª`, 
                margin + 10, 
                margin + W * scale + 25
            );
            
            const phase = document.getElementById('compostPhase').value;
            let phaseText = '';
            switch(phase) {
                case "2": phaseText = "Ø·ÙˆØ± II"; break;
                case "3": phaseText = "Ø·ÙˆØ± III"; break;
                case "4": phaseText = "Ø·ÙˆØ± IV"; break;
            }
            
            ctx.fillText(
                `Ù†ÙˆØ¹ Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª: ${phaseText}`, 
                margin + L * scale - 150, 
                margin + W * scale + 25
            );
        }

        // ==================== Charts ====================
        function updateCharts() {
            // Cost Distribution Chart
            const compostCost = parseFloat(document.getElementById('totalCompost').textContent) * 
                              parseFloat(document.getElementById('compostPrice').value);
            const peatCost = parseFloat(document.getElementById('peatCostResult').textContent) || 0;
            const operationalCosts = parseFloat(document.getElementById('operationalCosts').value);
            const revenue = parseFloat(document.getElementById('profitCycle').textContent.replace(/,/g, '')) + 
                          compostCost + peatCost + operationalCosts;
            
            if (charts.costDistribution) {
                charts.costDistribution.destroy();
            }
            
            const costCtx = document.getElementById('costDistributionChart').getContext('2d');
            charts.costDistribution = new Chart(costCtx, {
                type: 'pie',
                data: {
                    labels: ['Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª', 'Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³', 'Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©', 'Ø§Ù„Ø±Ø¨Ø­'],
                    datasets: [{
                        data: [compostCost, peatCost, operationalCosts, 
                               parseFloat(document.getElementById('profitCycle').textContent.replace(/,/g, ''))],
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'],
                        hoverBackgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            rtl: true,
                            labels: {
                                font: {
                                    family: 'Cairo'
                                }
                            }
                        }
                    }
                }
            });
            
            // Peat Comparison Chart
            if (charts.peatComparison) {
                charts.peatComparison.destroy();
            }
            
            const peatCtx = document.getElementById('peatComparisonChart').getContext('2d');
            charts.peatComparison = new Chart(peatCtx, {
                type: 'bar',
                data: {
                    labels: ['Ø§Ù„Ø®Ù„Ø·Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ©', 'Ø§Ù„Ø®Ù„Ø·Ø© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©', 'Ø§Ù„Ø®Ù„Ø·Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©', 'Ø§Ù„Ø®Ù„Ø·Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©'],
                    datasets: [{
                        label: 'Ø§Ù„ØªÙƒÙ„ÙØ© ($/Ù…Â²)',
                        data: [1.35, 1.80, 1.20, 2.00],
                        backgroundColor: 'rgba(54, 162, 235, 0.5)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }, {
                        label: 'Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© (%)',
                        data: [100, 115, 90, 120],
                        backgroundColor: 'rgba(75, 192, 192, 0.5)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            rtl: true,
                            labels: {
                                font: {
                                    family: 'Cairo'
                                }
                            }
                        }
                    }
                }
            });
            
            // Profitability Chart
            if (charts.profitability) {
                charts.profitability.destroy();
            }
            
            const profitCtx = document.getElementById('profitabilityChart').getContext('2d');
            const monthlyProfit = parseFloat(document.getElementById('profitCycle').textContent.replace(/,/g, '')) * 
                                 parseFloat(document.getElementById('compostPhase').value === '3' ? 0.5 : 0.4);
            
            charts.profitability = new Chart(profitCtx, {
                type: 'line',
                data: {
                    labels: ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'],
                    datasets: [{
                        label: 'Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠ ($)',
                        data: Array(12).fill(0).map((_, i) => monthlyProfit * (0.8 + Math.random() * 0.4)),
                        borderColor: '#4BC0C0',
                        backgroundColor: 'rgba(75, 192, 192, 0.1)',
                        borderWidth: 2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            rtl: true,
                            labels: {
                                font: {
                                    family: 'Cairo'
                                }
                            }
                        }
                    }
                }
            });
            
            // Sensitivity Analysis
            if (charts.sensitivity) {
                charts.sensitivity.destroy();
            }
            
            const sensitivityCtx = document.getElementById('sensitivityChart').getContext('2d');
            const baseYield = parseFloat(document.getElementById('yieldPerSqM').value);
            
            charts.sensitivity = new Chart(sensitivityCtx, {
                type: 'radar',
                data: {
                    labels: ['Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹', 'Ø¥Ù†ØªØ§Ø¬ÙŠØ©/Ù…Â²', 'ØªÙƒÙ„ÙØ© Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª', 'ØªÙƒÙ„ÙØ© Ø§Ù„Ø¨ÙŠØªÙ…ÙˆØ³', 'Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙˆØ±Ø§Øª'],
                    datasets: [{
                        label: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©',
                        data: [
                            parseFloat(document.getElementById('mushroomPrice').value) * 10,
                            baseYield,
                            parseFloat(document.getElementById('compostPrice').value) / 5,
                            parseFloat(document.getElementById('peatPrice').value) * 100,
                            parseFloat(document.getElementById('compostPhase').value) * 2
                        ],
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(255, 99, 132, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            rtl: true,
                            labels: {
                                font: {
                                    family: 'Cairo'
                                }
                            }
                        }
                    }
                }
            });
        }

        // ==================== Save/Load Configuration ====================
        function saveConfiguration() {
            const config = {
                id: Date.now(),
                name: prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ù„Ù„ØªÙƒÙˆÙŠÙ†:', `ØªÙƒÙˆÙŠÙ† ${new Date().toLocaleDateString()}`) || `ØªÙƒÙˆÙŠÙ† ${new Date().toLocaleDateString()}`,
                date: new Date().toISOString(),
                data: {}
            };
            
            // Save all input values
            document.querySelectorAll('input, select').forEach(element => {
                config.data[element.id] = element.value;
            });
            
            savedConfigurations.push(config);
            localStorage.setItem('mushroomConfigs', JSON.stringify(savedConfigurations));
            
            updateSavedConfigsCount();
            showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­');
        }

        function loadConfiguration() {
            if (savedConfigurations.length === 0) {
                showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙƒÙˆÙŠÙ†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©', 'warning');
                return;
            }
            
            const configNames = savedConfigurations.map((config, index) => 
                `${index + 1}. ${config.name} (${new Date(config.date).toLocaleDateString()})`
            ).join('\n');
            
            const choice = prompt(`Ø§Ø®ØªØ± ØªÙƒÙˆÙŠÙ† Ù„Ù„ØªØ­Ù…ÙŠÙ„:\n${configNames}\n\nØ£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù…:`);
            const index = parseInt(choice) - 1;
            
            if (index >= 0 && index < savedConfigurations.length) {
                const config = savedConfigurations[index];
                
                // Load all values
                for (const [key, value] of Object.entries(config.data)) {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = value;
                    }
                }
                
                // Recalculate everything
                validateInputs();
                updatePhaseSettings();
                updateTreatmentCost();
                calculateAll();
                
                showToast(`ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙƒÙˆÙŠÙ†: ${config.name}`);
            }
        }

        function showSavedConfigs() {
            if (savedConfigurations.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙƒÙˆÙŠÙ†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©');
                return;
            }
            
            let message = 'Ø§Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:\n\n';
            savedConfigurations.forEach((config, index) => {
                message += `${index + 1}. ${config.name}\n`;
                message += `   Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date(config.date).toLocaleDateString()}\n`;
                message += `   Ø§Ù„Ù…Ø³Ø§Ø­Ø©: ${config.data.roomLength || '?'} Ã— ${config.data.roomWidth || '?'} Ù…\n`;
                message += `   Ù†ÙˆØ¹ Ø§Ù„ÙƒÙˆÙ…Ø¨ÙˆØ³Øª: ${config.data.compostPhase === '3' ? 'Ø·ÙˆØ± III' : 'Ø·ÙˆØ± II'}\n\n`;
            });
            
            alert(message);
        }

        function clearAllConfigs() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©ØŸ')) {
                localStorage.removeItem('mushroomConfigs');
                savedConfigurations = [];
                updateSavedConfigsCount();
                showToast('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª', 'warning');
            }
        }

        function updateSavedConfigsCount() {
            document.getElementById('savedConfigsCount').textContent = savedConfigurations.length;
        }

        // ==================== Export Functions ====================
        function exportData(format) {
            const data = {
                roomDimensions: {
                    length: document.getElementById('roomLength').value,
                    width: document.getElementById('roomWidth').value,
                    aisleWidth: document.getElementById('aisleWidth').value
                },
                shelves: {
                    levels: document.getElementById('shelfLevels').value,
                    width: document.getElementById('shelfWidth').value
                },
                agriculture: {
                    compostPhase: document.getElementById('compostPhase').value,
                    compostDensity: document.getElementById('compostDensity').value,
                    yield: document.getElementById('yieldPerSqM').value
                },
                financial: {
                    exchangeRate: document.getElementById('exchangeRate').value,
                    compostPrice: document.getElementById('compostPrice').value,
                    mushroomPrice: document.getElementById('mushroomPrice').value,
                    operationalCosts: document.getElementById('operationalCosts').value
                },
                peat: {
                    type: document.getElementById('peatType').value,
                    thickness: document.getElementById('peatThickness').value,
                    perlite: document.getElementById('addPerlite').value,
                    price: document.getElementById('peatPrice').value,
                    treatment: document.getElementById('treatmentMethod').value
                },
                results: {
                    totalArea: document.getElementById('totalArea').textContent,
                    totalCompost: document.getElementById('totalCompost').textContent,
                    totalPeat: document.getElementById('totalPeat').textContent,
                    annualYield: document.getElementById('annualYield').textContent,
                    profitCycle: document.getElementById('profitCycle').textContent,
                    profitAnnualSYP: document.getElementById('profitAnnualSYP').textContent
                }
            };
            
            let content;
            if (format === 'csv') {
                content = convertToCSV(data);
                downloadFile(content, 'mushroom_farm_data.csv', 'text/csv');
            } else if (format === 'excel') {
                // For simplicity, we'll create a CSV that Excel can open
                content = convertToCSV(data);
                downloadFile(content, 'mushroom_farm_data.xls', 'application/vnd.ms-excel');
            }
            
            showToast(`ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ€ ${format.toUpperCase()}`);
        }

        function convertToCSV(obj) {
            const rows = [];
            
            // Add headers
            rows.push(['Ø§Ù„Ù‚Ø³Ù…', 'Ø§Ù„Ù…Ø¹Ù„Ù…Ø©', 'Ø§Ù„Ù‚ÙŠÙ…Ø©', 'Ø§Ù„ÙˆØ­Ø¯Ø©']);
            
            // Add data
            for (const [section, values] of Object.entries(obj)) {
                for (const [key, value] of Object.entries(values)) {
                    rows.push([section, key, value, '']);
                }
                rows.push(['', '', '', '']); // Empty row between sections
            }
            
            return rows.map(row => row.join(',')).join('\n');
        }

        function downloadFile(content, fileName, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(url);
        }

        function exportToPDF() {
            showToast('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF...', 'warning');
            // In a real implementation, you would use a PDF library like jsPDF
            setTimeout(() => {
                showToast('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF Ø¨Ù†Ø¬Ø§Ø­');
            }, 2000);
        }

        function printReport() {
            window.print();
        }

        // ==================== Utility Functions ====================
        function resetToDefaults() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙŠÙ… Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©ØŸ')) {
                document.getElementById('roomLength').value = 18;
                document.getElementById('roomWidth').value = 5.5;
                document.getElementById('aisleWidth').value = 0.8;
                document.getElementById('shelfLevels').value = 5;
                document.getElementById('shelfWidth').value = 1.2;
                document.getElementById('compostPhase').value = 3;
                document.getElementById('compostDensity').value = 95;
                document.getElementById('yieldPerSqM').value = 30;
                document.getElementById('exchangeRate').value = 15000;
                document.getElementById('compostPrice').value = 280;
                document.getElementById('mushroomPrice').value = 2.5;
                document.getElementById('operationalCosts').value = 400;
                document.getElementById('peatType').value = 2;
                document.getElementById('peatThickness').value = 4.5;
                document.getElementById('addPerlite').value = 0;
                document.getElementById('peatPrice').value = 0.03;
                document.getElementById('treatmentMethod').value = 'pasteurization';
                document.getElementById('targetMoisture').value = 75;
                
                validateInputs();
                updatePhaseSettings();
                updateTreatmentCost();
                calculateAll();
                
                showToast('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
            }
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>